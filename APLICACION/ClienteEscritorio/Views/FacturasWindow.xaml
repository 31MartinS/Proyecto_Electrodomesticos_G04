<Window x:Class="ClienteEscritorio.Views.FacturasWindow"
        xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
        xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
        xmlns:converters="clr-namespace:ClienteEscritorio.Converters"
        Title="Historial de Facturas" 
        Height="600" 
        Width="1000"
        WindowStartupLocation="CenterScreen"
        Background="{StaticResource BackgroundBrush}">
    <Window.Resources>
        <converters:ImageUrlConverter x:Key="ImageUrlConverter"/>
    </Window.Resources>
    <Grid Margin="20">
        <Grid.RowDefinitions>
            <RowDefinition Height="Auto"/>
            <RowDefinition Height="Auto"/>
            <RowDefinition Height="*"/>
            <RowDefinition Height="Auto"/>
        </Grid.RowDefinitions>

        <!-- Título -->
        <TextBlock Grid.Row="0" 
                   Text="Historial de Facturas" 
                   Style="{StaticResource MainTitle}"/>

        <!-- Panel de búsqueda -->
        <StackPanel Grid.Row="1" Orientation="Horizontal" Margin="0,20,0,10">
            <TextBlock Text="Cédula del cliente:" 
                       VerticalAlignment="Center" 
                       Margin="0,0,10,0"
                       FontSize="16"/>
            <TextBox x:Name="TxtCedula" 
                     Width="150" 
                     Height="35"
                     VerticalContentAlignment="Center"
                     MaxLength="10"/>
            <Button Content="BUSCAR" 
                    Background="{StaticResource GreenButtonBrush}"
                    Foreground="Black"
                    Padding="20,8"
                    Margin="10,0,0,0"
                    BorderThickness="0"
                    Cursor="Hand"
                    Click="BtnBuscar_Click">
                <Button.Template>
                    <ControlTemplate TargetType="Button">
                        <Border Background="{TemplateBinding Background}"
                                CornerRadius="20"
                                Padding="{TemplateBinding Padding}">
                            <ContentPresenter HorizontalAlignment="Center" VerticalAlignment="Center"/>
                        </Border>
                    </ControlTemplate>
                </Button.Template>
            </Button>
        </StackPanel>

        <!-- DataGrid de Facturas -->
        <DataGrid x:Name="DgFacturas" 
                  Grid.Row="2"
                  AutoGenerateColumns="False"
                  CanUserAddRows="False"
                  CanUserDeleteRows="False"
                  IsReadOnly="True"
                  SelectionMode="Single"
                  HeadersVisibility="Column"
                  GridLinesVisibility="None"
                  Background="White"
                  RowBackground="White"
                  AlternatingRowBackground="#F5F5F5"
                  BorderBrush="#D9D9D9"
                  BorderThickness="1">
            <DataGrid.Columns>
                <DataGridTextColumn Header="Número Factura" Binding="{Binding NumeroFactura}" Width="150"/>
                <DataGridTextColumn Header="Fecha" Binding="{Binding Fecha, StringFormat='dd/MM/yyyy HH:mm'}" Width="150"/>
                <DataGridTextColumn Header="Cliente" Width="200">
                    <DataGridTextColumn.Binding>
                        <MultiBinding StringFormat="{}{0} {1}">
                            <Binding Path="Cliente.Nombres"/>
                            <Binding Path="Cliente.Apellidos"/>
                        </MultiBinding>
                    </DataGridTextColumn.Binding>
                </DataGridTextColumn>
                <DataGridTextColumn Header="Forma Pago" Binding="{Binding FormaPago}" Width="100"/>
                <DataGridTextColumn Header="Total" Binding="{Binding Total, StringFormat=C2}" Width="120"/>
                <DataGridTemplateColumn Header="Acciones" Width="*">
                    <DataGridTemplateColumn.CellTemplate>
                        <DataTemplate>
                            <Button Content="Ver Detalle" 
                                    Background="#4A90E2"
                                    Foreground="White"
                                    Padding="15,5"
                                    Margin="5"
                                    BorderThickness="0"
                                    Cursor="Hand"
                                    Click="BtnVerDetalle_Click"
                                    Tag="{Binding}">
                                <Button.Template>
                                    <ControlTemplate TargetType="Button">
                                        <Border Background="{TemplateBinding Background}"
                                                CornerRadius="15"
                                                Padding="{TemplateBinding Padding}">
                                            <ContentPresenter HorizontalAlignment="Center" VerticalAlignment="Center"/>
                                        </Border>
                                    </ControlTemplate>
                                </Button.Template>
                            </Button>
                        </DataTemplate>
                    </DataGridTemplateColumn.CellTemplate>
                </DataGridTemplateColumn>
            </DataGrid.Columns>
        </DataGrid>

        <!-- Botón Volver -->
        <Button Grid.Row="3" 
                Content="VOLVER" 
                Style="{StaticResource PillButton}"
                Background="{StaticResource GrayButtonBrush}"
                Width="200"
                Height="45"
                Margin="0,20,0,0"
                HorizontalAlignment="Center"
                Click="BtnVolver_Click"/>
    </Grid>
</Window>
