<?xml version="1.0" encoding="utf-8" ?>
<ContentPage xmlns="http://schemas.microsoft.com/dotnet/2021/maui"
             xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
             x:Class="ClienteMovil.Pages.ProductosPage"
             Title="ElectrodomÃ©sticos">
    <Grid RowDefinitions="Auto,Auto,*">
        
        <!-- Header -->
        <Frame Grid.Row="0" 
               BackgroundColor="#96FF96" 
               CornerRadius="0" 
               Padding="20">
            <Grid ColumnDefinitions="*,Auto">
                <Label Text="ElectrodomÃ©sticos"
                       FontSize="24"
                       FontAttributes="Bold"
                       TextColor="#000000"
                       HorizontalOptions="Center"
                       VerticalOptions="Center"/>
                
                <!-- BotÃ³n Carrito con Badge -->
                <Frame Grid.Column="1"
                       BackgroundColor="#FFD700"
                       CornerRadius="25"
                       Padding="10"
                       HasShadow="True">
                    <Frame.GestureRecognizers>
                        <TapGestureRecognizer Tapped="OnVerCarritoClicked"/>
                    </Frame.GestureRecognizers>
                    <Grid>
                        <Label Text="ðŸ›’"
                               FontSize="24"
                               VerticalOptions="Center"
                               HorizontalOptions="Center"/>
                        <Label x:Name="BadgeLabel"
                               Text=""
                               FontSize="10"
                               FontAttributes="Bold"
                               TextColor="White"
                               BackgroundColor="Red"
                               WidthRequest="18"
                               HeightRequest="18"
                               HorizontalTextAlignment="Center"
                               VerticalTextAlignment="Center"
                               HorizontalOptions="End"
                               VerticalOptions="Start"
                               Margin="0,-5,-5,0"
                               IsVisible="False">
                            <Label.Clip>
                                <EllipseGeometry Center="9,9" RadiusX="9" RadiusY="9"/>
                            </Label.Clip>
                        </Label>
                    </Grid>
                </Frame>
            </Grid>
        </Frame>

        <!-- InstrucciÃ³n -->
        <Label Grid.Row="1"
               Text="Selecciona: Efectivo (compra inmediata) | CrÃ©dito (compra inmediata) | Carrito (comprar varios)"
               FontSize="12"
               TextColor="#666"
               HorizontalOptions="Center"
               Margin="10,10,10,5"/>
        
        <!-- Lista de Productos -->
        <RefreshView Grid.Row="2" 
                     x:Name="RefreshView" 
                     Refreshing="OnRefreshing">
            <CollectionView x:Name="ProductosCollection"
                            SelectionMode="None">
                <CollectionView.ItemsLayout>
                    <LinearItemsLayout Orientation="Vertical" ItemSpacing="10"/>
                </CollectionView.ItemsLayout>
                <CollectionView.EmptyView>
                    <VerticalStackLayout Padding="20" VerticalOptions="Center">
                        <Label Text="ðŸ“¦"
                               FontSize="60"
                               HorizontalOptions="Center"/>
                        <Label Text="No hay productos disponibles"
                               FontSize="16"
                               HorizontalOptions="Center"
                               TextColor="#999"/>
                    </VerticalStackLayout>
                </CollectionView.EmptyView>
                <CollectionView.ItemTemplate>
                    <DataTemplate>
                        <Frame Margin="10,5" 
                               Padding="0" 
                               CornerRadius="15" 
                               HasShadow="True">
                            <Grid Padding="15" ColumnDefinitions="80,*" RowDefinitions="Auto,Auto,Auto,Auto">
                                
                                <!-- Imagen -->
                                <Frame Grid.Row="0"
                                       Grid.RowSpan="4"
                                       Grid.Column="0"
                                       CornerRadius="10"
                                       Padding="0"
                                       HeightRequest="80"
                                       WidthRequest="80"
                                       HasShadow="False"
                                       BackgroundColor="#F0F0F0">
                                    <Image Source="{Binding ImageUrl}"
                                           Aspect="AspectFill"/>
                                </Frame>
                                
                                <!-- Nombre -->
                                <Label Grid.Row="0" 
                                       Grid.Column="1"
                                       Text="{Binding Nombre}"
                                       FontSize="16"
                                       FontAttributes="Bold"
                                       Margin="10,0,0,5"/>
                                
                                <!-- Precio -->
                                <Label Grid.Row="1" 
                                       Grid.Column="1"
                                       Text="{Binding PrecioVenta, StringFormat='${0:N2}'}"
                                       FontSize="18"
                                       TextColor="#4CAF50"
                                       FontAttributes="Bold"
                                       Margin="10,0,0,5"/>
                                
                                <!-- BotÃ³n Agregar al Carrito -->
                                <Button Grid.Row="2"
                                        Grid.Column="1"
                                        Text="ðŸ›’ Agregar al Carrito"
                                        BackgroundColor="#FFA500"
                                        TextColor="White"
                                        CornerRadius="20"
                                        FontSize="12"
                                        Padding="10,5"
                                        Margin="10,5,0,5"
                                        CommandParameter="{Binding .}"
                                        Clicked="OnAgregarCarritoClicked"/>
                                
                                <!-- Botones Compra Directa -->
                                <HorizontalStackLayout Grid.Row="3" 
                                                       Grid.Column="1"
                                                       Spacing="10"
                                                       Margin="10,5,0,0">
                                    <Button Text="Efectivo"
                                            BackgroundColor="#96FF96"
                                            TextColor="#000000"
                                            CornerRadius="20"
                                            FontSize="11"
                                            Padding="12,5"
                                            CommandParameter="{Binding .}"
                                            Clicked="OnEfectivoClicked"/>
                                    
                                    <Button Text="CrÃ©dito"
                                            BackgroundColor="#FFD700"
                                            TextColor="#000000"
                                            CornerRadius="20"
                                            FontSize="11"
                                            Padding="12,5"
                                            CommandParameter="{Binding .}"
                                            Clicked="OnCreditoClicked"/>
                                </HorizontalStackLayout>
                                
                            </Grid>
                        </Frame>
                    </DataTemplate>
                </CollectionView.ItemTemplate>
            </CollectionView>
        </RefreshView>
        
    </Grid>
</ContentPage>
